<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/productivity-news/favicon/favicon.ico"/><link rel="icon" href="/productivity-news/favicon/icon.svg" type="image/svg+xml"/><link rel="apple-touch-icon" href="/productivity-news/favicon/apple-touch-icon.png"/><link rel="manifest" href="/productivity-news/favicon/site.webmanifest"/><meta name="theme-color" content="#000"/><meta property="og:image" content="https://cybozu.github.io/productivity-news/og-image.png"/><meta name="twitter:image" content="https://cybozu.github.io/productivity-news/twitter-card.png"/><meta name="twitter:card" content="summary_large_image"/><title>#2 - 2022.04.28 | Cybozu Productivity News</title><meta name="og:title" content="#2 - 2022.04.28 | Cybozu Productivity News"/><meta name="next-head-count" content="12"/><link rel="preload" href="/productivity-news/_next/static/css/e9b3e6a132e6efce.css" as="style"/><link rel="stylesheet" href="/productivity-news/_next/static/css/e9b3e6a132e6efce.css" data-n-g=""/><link rel="preload" href="/productivity-news/_next/static/css/236a9c0f78af5b56.css" as="style"/><link rel="stylesheet" href="/productivity-news/_next/static/css/236a9c0f78af5b56.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/productivity-news/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/productivity-news/_next/static/chunks/webpack-473f7a533704d3c7.js" defer=""></script><script src="/productivity-news/_next/static/chunks/framework-6fb3980f016be2d7.js" defer=""></script><script src="/productivity-news/_next/static/chunks/main-4f8d1876aae14607.js" defer=""></script><script src="/productivity-news/_next/static/chunks/pages/_app-1e17a6754614af77.js" defer=""></script><script src="/productivity-news/_next/static/chunks/72-915495b5abb2d97e.js" defer=""></script><script src="/productivity-news/_next/static/chunks/pages/posts/%5Byear%5D/%5Bslug%5D-6b5584d8c88e1283.js" defer=""></script><script src="/productivity-news/_next/static/rboL0jIl_DVyWORxnmwl7/_buildManifest.js" defer=""></script><script src="/productivity-news/_next/static/rboL0jIl_DVyWORxnmwl7/_ssgManifest.js" defer=""></script><script src="/productivity-news/_next/static/rboL0jIl_DVyWORxnmwl7/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="min-h-screen"><main><div class="container mx-auto px-5"><h2 class="text-2xl md:text-4xl font-bold tracking-tight md:tracking-tighter leading-tight mb-20 mt-8"><a class="hover:underline" href="/productivity-news/">Cybozu Productivity News</a></h2><article class="mb-32"><h1 class="text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left">#2 - 2022.04.28</h1><div class="max-w-full mx-auto"><div class="markdown-styles_markdown__h_8de"><h2><a href="https://github.blog/2022-03-16-save-time-partial-re-runs-github-actions/">GitHub Actions で一部のジョブだけ Re-run できるようになりました</a></h2>
<p>共有担当: <a href="https://twitter.com/miyajan">@miyajan</a></p>
<ul>
<li>GitHub Actions で、ジョブ単位で再実行したり、失敗したジョブのみ再実行したりできるようになりました</li>
<li>これまでは全ジョブをまとめて再実行するしかなかったので、大規模なワークフローで E2E テストのような不安定なジョブが含まれると、再実行時に余計なジョブを動かす時間やコストが厳しいという問題がありました</li>
<li><a href="https://zenn.dev/korosuke613/articles/productivity-weekly-20220316#ability-to-restart-individual-github-actions-ci-builds-%C2%B7-discussion-%234278-%C2%B7-github%2Ffeedback">参考</a></li>
</ul>
<h2><a href="https://zenn.dev/korosuke613/articles/productivity-weekly-20220316#tag-protection-rules-%7C-github-changelog">GitHub において Tag の保護ができるようになりました</a></h2>
<p>共有担当: <a href="https://github.com/korosuke613">@korosuke613</a></p>
<p>GitHub において Tag を保護できる Tag protection rules を設定できるようになりました。まだベータ機能です。</p>
<p>パターン（ワイルドカード可）にマッチするタグは作成・削除に制限がかかります。作成は Maintain、Admin ロールの保持者のみ。削除は Admin ロールの保持者のみできます。</p>
<p>Go などの Git tag が強い意味を持つようなリポジトリにおいて効果が発揮できそうです。しかし、タグ付けの部分も CI で自動化しているようなケースではあまり活用できないかもしれません<sup><a href="#user-content-fn-strong_user" id="user-content-fnref-strong_user" data-footnote-ref aria-describedby="footnote-label">1</a></sup>。</p>
<h2><a href="https://circleci.com/ja/changelog/#%E3%82%B8%E3%83%A7%E3%83%96%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B-oidc-%E3%83%88%E3%83%BC%E3%82%AF%E3%83%B3">CircleCI の OIDC 対応</a></h2>
<p>共有担当: <a href="https://twitter.com/miyajan">@miyajan</a></p>
<ul>
<li>CircleCI が OpenID Connect (OIDC) をサポートし、永続的なシークレットを使わずに AWS や GCP などのクラウドプロバイダへの認証が可能になりました
<ul>
<li>GitHub Actions では 2021/10 に同様の機能が公開されていました（<a href="https://zenn.dev/miyajan/articles/github-actions-support-openid-connect">参考</a>）</li>
</ul>
</li>
<li><a href="https://circleci.com/docs/ja/2.0/openid-connect-tokens/">ジョブでの OpenID Connect トークンの使用 - CircleCI</a></li>
<li><a href="https://dev.classmethod.jp/articles/circleci-supported-oidc-so-i-tried-linking-it-with-aws/">CircleCIがOpenID ConnectをサポートしたのでAWSと連携させてJWTを使用したAssumeRoleを試してみた | DevelopersIO</a></li>
<li>CircleCI 公式 Orb の OIDC 対応
<ul>
<li><a href="https://circleci.com/developer/ja/orbs/orb/circleci/aws-cli">circleci/aws-cli</a> は収録時には OIDC 対応していませんでしたが、配信時には対応された <a href="https://github.com/CircleCI-Public/aws-cli-orb/releases/tag/v3.1.0">v3.1.0</a> がリリースされました</li>
<li><a href="https://circleci.com/developer/ja/orbs/orb/circleci/gcp-cli">circleci/gcp-cli</a> はまだ OIDC サポートされていないため、認証は自前でスクリプトを書く必要があります
<ul>
<li><a href="https://twitter.com/CircleCIJapan/status/1509025350860255234">CircleCI Japan の Tweet</a> によると、<a href="https://circleci.canny.io/orbs/p/extend-existing-orbs-to-support-oidc">こちら</a>を Vote すると Orb 側での対応の優先度が上がるかもしれません</li>
<li>一応すでに <a href="https://github.com/CircleCI-Public/gcp-cli-orb/issues/41">issue</a> があります</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2><a href="https://zenn.dev/korosuke613/articles/productivity-weekly-20220406#%E3%83%9E%E3%83%AB%E3%83%81%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E5%AF%BE%E5%BF%9C%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8%E3%81%AE%E3%83%93%E3%83%AB%E3%83%89%E3%82%92%E3%81%A9%E3%81%86%E3%81%AB%E3%81%8B%E6%97%A9%E3%81%8F%E3%81%97%E3%81%9F%E3%81%8B%E3%81%A3%E3%81%9F---%E3%81%BD%E3%82%88%E3%83%A1%E3%83%A2">マルチアーキテクチャ対応イメージのビルドをどうにか早くしたかった</a></h2>
<p>共有担当: <a href="https://twitter.com/gkzvoice">@gkzvoice</a></p>
<ul>
<li>マルチアーキテクチャ対応イメージのビルドの方法とCI環境での高速化の検証記事です。</li>
<li><code>docker manifest</code> と <code>docker buildx</code> どちらもあまりよくわかっていなかったですが、ARM環境下でコンテナを扱うケースは増えるだろうと考え、取り上げました。</li>
<li>個人的には、コマンドやビルドの並列実行とコンテナ化を推し進めることで、コンテナ実行環境のCPUアーキテクチャを意識するようになったというのがおもしろいなーと。マルチアーキテクチャなコンテナ環境が一層求められるようになるのか？注目したいですね。</li>
</ul>
<h2><a href="https://zenn.dev/miroha/articles/whats-docker-compose-v2">Docker Compose V2で変わったdocker-compose.ymlの書き方</a></h2>
<p>共有担当: <a href="https://twitter.com/ganta0087">@ganta0087</a></p>
<ul>
<li>Docker Compose v2はv1の記法の後方互換性を保ちつつ、新たに<a href="https://github.com/compose-spec/compose-spec/blob/master/spec.md">Compose Specification</a>に準拠した記法が使えるようになりました。</li>
<li>Docker ComposeはCompose Specificationのリファレンス実装となっており、他には<a href="https://github.com/containerd/nerdctl">Nerdctl</a>などで実装されています。</li>
<li>Composeファイルの名前は<code>compose.{yaml,yml}</code>が追加され、探索順はそちらが優先されるようになっていたり、<code>version</code>プロパティの記述が不要となっていたりします。</li>
<li>こちらの記事では紹介されていないのですが、<a href="https://github.com/compose-spec/compose-spec/blob/master/spec.md#profiles">Profiles</a>が便利だと思いました。
<ul>
<li><a href="https://docs.docker.com/compose/profiles/">DockerのProfilesについてのドキュメント</a></li>
</ul>
</li>
</ul>
<h2><a href="https://github.com/hashicorp/terraform-provider-aws/blob/main/CHANGELOG.md#490-april-07-2022">Terraform AWS Provider 4.9.0 (April 07, 2022)リリース</a></h2>
<p>共有担当: <a href="https://twitter.com/gkzvoice">@gkzvoice</a></p>
<ul>
<li>前提として、AWS Provider 4.0で <code>aws_s3_bucket</code> リソースの仕様変更があり、それに合わない書き方はエラー判定とされていました。
<ul>
<li><a href="https://github.com/hashicorp/terraform-provider-aws/issues/23125">https://github.com/hashicorp/terraform-provider-aws/issues/23125</a></li>
</ul>
</li>
<li>4.9.0 ではエラー判定ではなく、WARNING判定とドリフト検知がされることとなりました。
<ul>
<li>AWS Providerのバージョンを3.70.0から4.9に引き上げてみたときの作業ログ
<ul>
<li><a href="https://gkzz.dev/posts/changes-to-s3-bucket-drift-detection-with-aws-provider-v4/">[Changes to S3 Bucket Drift Detection] Terraform AWS Provider 4.9のaws_s3_bucketリソースにおけるアップデート内容 | gkzz.dev</a></li>
</ul>
</li>
<li>クラスメソッドさんの検証記事
<ul>
<li><a href="https://dev.classmethod.jp/articles/terraform-s3-v4-9-0-refactoring/">【Terraform】AWS Provider v4.9.0のS3リファクタリングの挙動を試してみた | DevelopersIO</a></li>
</ul>
</li>
</ul>
</li>
<li>今後のアップデートでエラー判定とする仕様に戻るか分からない以上、<code>aws_s3_bucket</code> リソースの仕様変更に追随したほうがよいとは思います。検証を重ねて仕様変更にキャッチアップしたいですね。</li>
<li>詳細はTerraform のドキュメントの以下のページが一番詳しかったです。
<ul>
<li><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/guides/version-4-upgrade#changes-to-s3-bucket-drift-detection">Changes to S3 Bucket Drift Detection | Terraform Registry</a></li>
</ul>
</li>
</ul>
<h2><a href="https://aws.amazon.com/blogs/aws/announcing-aws-lambda-function-urls-built-in-https-endpoints-for-single-function-microservices/">AWS Lambda が単体でHTTPSエンドポイントを持てるようになりました</a></h2>
<p>共有担当: <a href="https://twitter.com/ganta0087">@ganta0087</a></p>
<ul>
<li>これまではちょっとしたWebhookのエンドポイントを作りたいときにはAPI Gatewayを併用する必要がありました。</li>
<li>設定からFunction URLを有効にすると<code>https://&#x3C;url-id>.lambda-url.&#x3C;region>.on.aws</code>の形式でURLが払い出されます。</li>
<li>対応している認証方式はIAMのみです。</li>
<li>Webページ内から呼び出す場合はCORSの設定で許可するオリジンを指定できます。</li>
<li>費用はLambdaの呼び出し料金に含まれており、Function URLsの追加による費用はありません。</li>
<li><a href="https://dev.classmethod.jp/articles/aws-lambda-function-urls-built-in-https-endpoints/">[アップデート]LambdaがHTTPSエンドポイントから実行可能になる、AWS Lambda Function URLsの機能が追加されました！ | DevelopersIO</a></li>
</ul>
<h2><a href="https://zenn.dev/korosuke613/articles/productivity-weekly-20220323#playwright-%26-vite-%E3%81%A7%E3%81%AF%E3%81%98%E3%82%81%E3%82%8B%E8%84%B1%E3%83%AC%E3%82%AC%E3%82%B7%E3%83%BC%E5%90%91%E3%81%91%E8%BB%BD%E9%87%8F-visual-regression-test">Playwright &#x26; Vite ではじめる脱レガシー向け軽量 Visual Regression Test</a></h2>
<p>共有担当: <a href="https://github.com/korosuke613">@korosuke613</a></p>
<p>テストフレームワークの Playwright と TypeScript のビルドツールである Vite を使って軽量な Visual Regression Test (VRT) を行うというノウハウ記事です。VRT の説明や Playwright での始め方、Vite との組合せ方などが載っています。</p>
<p>僕もこの記事を参考に自身のホームページに VRT 導入してみました<sup><a href="#user-content-fn-unused_vite" id="user-content-fnref-unused_vite" data-footnote-ref aria-describedby="footnote-label">2</a></sup>。プルリクエスト時に、CI で main ブランチとトピックブランチそれぞれでビルド＆サーブし、見た目上の差分が無いかを確認します。主に Renovate などを用いた依存関係更新に利用する想定です。時たま不安定になったり、CI 上で比較するには工夫が必要だったりと大変でした。見た目が変わらないことを保証できるのがやはり良く、今では Renovate が作成するプルリクエストを安心して automerge できるようになったのが嬉しいですね。</p>
<h2><a href="https://cypress-io.ghost.io/blog/2022/03/28/real-world-testing-with-cypress/">Introducing Real World Testing with Cypress</a></h2>
<p>共有担当: <a href="https://twitter.com/akihisa1210">@akihisa1210</a></p>
<ul>
<li>E2E テストフレームワーク Cypress を開発している Cypress 社が、チュートリアルサイト <a href="https://learn.cypress.io/">Real World Testing with Cypress</a> を公開しました</li>
<li>このサイトは、「開発者が良いテストを書くために知っておくべき情報が散らばっている」という課題を解決するために作られました。</li>
<li><a href="https://learn.cypress.io/">4コースの学習リソース</a>、<a href="https://learn.cypress.io/real-world-examples">テストが書かれたサンプルアプリケーションとその解説</a>、<a href="https://learn.cypress.io/tutorials">アプリを作成してテストを書くチュートリアル</a>が含まれています。
<ul>
<li>4コースの学習リソースには<a href="https://learn.cypress.io/cypress-fundamentals">Cypress の使い方</a>だけでなく、<a href="https://learn.cypress.io/testing-foundations">テストの考え方自体</a>の学習リソースも含まれているのが特徴的です。</li>
</ul>
</li>
<li>また、<a href="https://github.com/cypress-io/cypress-realworld-testing">サイト自体が OSS として公開されており</a>、<a href="https://github.com/cypress-io/cypress-realworld-testing/tree/main/cypress/integration">E2E テストが Cypress で書かれています</a>。</li>
</ul>
<h2>その他の注目ネタ</h2>
<ul>
<li>GitHub
<ul>
<li><a href="https://zenn.dev/korosuke613/articles/productivity-weekly-20220323#github-actions%3A-restrict-self-hosted-runner-groups-to-specific-workflows-%7C-github-changelog">指定したワークフローのみ利用を許可する設定をセルフホストランナーグループにできるようになりました</a></li>
<li><a href="https://zenn.dev/korosuke613/articles/productivity-weekly-20220323#introducing-the-ghes-repository-cache-%7C-the-github-blog">GHESでGitリポジトリのキャッシュサーバを利用できるようになりました</a></li>
<li><a href="https://zenn.dev/korosuke613/articles/productivity-weekly-20220330#ignore-commits-in-the-blame-view-(beta)-%7C-github-changelog">Ignore commits in the blame view (Beta) | GitHub Changelog</a></li>
<li><a href="https://zenn.dev/korosuke613/articles/productivity-weekly-20220413#github-action-for-dependency-review-enforcement-%7C-github-changelog">依存関係をレビューする公式 GitHub Actions アクションが登場しました</a></li>
</ul>
</li>
<li>CircleCI
<ul>
<li><a href="https://zenn.dev/korosuke613/articles/productivity-weekly-20220316#ubuntu-14.04-and-16.04-image-deprecation---circleci-changelog">Ubuntu 14.04、16.04 のマシンイメージが使えなくなるよ</a></li>
</ul>
</li>
<li>Terraform
<ul>
<li><a href="https://zenn.dev/korosuke613/articles/productivity-weekly-20220323#terraform-%E3%81%A8-gcloud-cli-%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E5%AE%8C%E7%92%A7%E3%81%AA-google-cloud-%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E3%82%B9%E3%83%88%E3%83%A9%E3%82%AF%E3%83%81%E3%83%A3%E3%81%AE%E6%A7%8B%E7%AF%89-%7C-google-cloud-blog">Terraform と gcloud CLI を使用した完璧な Google Cloud インフラストラクチャの構築 | Google Cloud Blog</a></li>
</ul>
</li>
<li>その他
<ul>
<li><a href="https://zenn.dev/korosuke613/articles/productivity-weekly-20220316#ssh-and-git%2C-meet-1password-%F0%9F%A5%B0">SSH and Git, meet 1Password 🥰</a></li>
<li><a href="https://zenn.dev/korosuke613/articles/productivity-weekly-20220323#twitterdev%2Ftwitter-api-typescript-sdk%3A-a-typescript-sdk-for-the-twitter-api">twitterdev/twitter-api-typescript-sdk: A TypeScript SDK for the Twitter API</a></li>
<li><a href="https://zenn.dev/korosuke613/articles/productivity-weekly-20220406#technology-radar-%7C-an-opinionated-guide-to-technology-frontiers-%7C-thoughtworks">Technology Radar Vol.26が公開</a></li>
</ul>
</li>
</ul>
<hr>
<h1>We are hiring</h1>
<a href="https://note.com/cybozu_dev/n/n1c1b44bf72f6">
<img src="https://user-images.githubusercontent.com/471182/156986297-b189ef3d-98d3-4490-af5c-007a4ab47e5e.png" alt="サイボウズの開発者の生産性を上げる「生産性向上チーム」とは！？" width="600">
</a>
<section data-footnotes class="footnotes"><h2 id="footnote-label" class="sr-only">Footnotes</h2>
<ol>
<li id="user-content-fn-strong_user">
<p>強い権限を持ったユーザの Personal Access Token を使うなどすれば良いけど、あんまり強い権限のトークンを出したくなかったり、Actions の場合は GITHUB_TOKEN を使いたかったりしますよね。 <a href="#user-content-fnref-strong_user" data-footnote-backref class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-unused_vite">
<p>詳しくはこの<a href="https://github.com/korosuke613/myHomepage/compare/9f248dab326ee93b9e12c83d15f80f68692f0602..045bd4624f464fe09a255eb11f10df602fd062c8">差分</a>と <a href="https://app.circleci.com/pipelines/github/korosuke613/myHomepage">CI</a> の <code>visual-regression-testing</code> ワークフローを参照。Vite の導入は型周りでのエラーが頻発して導入を諦めました... <a href="#user-content-fnref-unused_vite" data-footnote-backref class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
</ol>
</section>
</div></div></article></div></main></div><footer class="bg-neutral-50 border-t border-neutral-200"><div class="container mx-auto px-5"><div class="py-10 flex flex-col lg:flex-row items-center"><div class="flex flex-col lg:flex-row justify-center items-center lg:pl-4 lg:w-1/2"><a href="https://github.com/cybozu/productivity-news" class="mx-3 font-bold hover:underline">View on GitHub</a></div></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"#2 - 2022.04.28","year":"2022","slug":"04-28","content":"\u003ch2\u003e\u003ca href=\"https://github.blog/2022-03-16-save-time-partial-re-runs-github-actions/\"\u003eGitHub Actions で一部のジョブだけ Re-run できるようになりました\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e共有担当: \u003ca href=\"https://twitter.com/miyajan\"\u003e@miyajan\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eGitHub Actions で、ジョブ単位で再実行したり、失敗したジョブのみ再実行したりできるようになりました\u003c/li\u003e\n\u003cli\u003eこれまでは全ジョブをまとめて再実行するしかなかったので、大規模なワークフローで E2E テストのような不安定なジョブが含まれると、再実行時に余計なジョブを動かす時間やコストが厳しいという問題がありました\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zenn.dev/korosuke613/articles/productivity-weekly-20220316#ability-to-restart-individual-github-actions-ci-builds-%C2%B7-discussion-%234278-%C2%B7-github%2Ffeedback\"\u003e参考\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e\u003ca href=\"https://zenn.dev/korosuke613/articles/productivity-weekly-20220316#tag-protection-rules-%7C-github-changelog\"\u003eGitHub において Tag の保護ができるようになりました\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e共有担当: \u003ca href=\"https://github.com/korosuke613\"\u003e@korosuke613\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eGitHub において Tag を保護できる Tag protection rules を設定できるようになりました。まだベータ機能です。\u003c/p\u003e\n\u003cp\u003eパターン（ワイルドカード可）にマッチするタグは作成・削除に制限がかかります。作成は Maintain、Admin ロールの保持者のみ。削除は Admin ロールの保持者のみできます。\u003c/p\u003e\n\u003cp\u003eGo などの Git tag が強い意味を持つようなリポジトリにおいて効果が発揮できそうです。しかし、タグ付けの部分も CI で自動化しているようなケースではあまり活用できないかもしれません\u003csup\u003e\u003ca href=\"#user-content-fn-strong_user\" id=\"user-content-fnref-strong_user\" data-footnote-ref aria-describedby=\"footnote-label\"\u003e1\u003c/a\u003e\u003c/sup\u003e。\u003c/p\u003e\n\u003ch2\u003e\u003ca href=\"https://circleci.com/ja/changelog/#%E3%82%B8%E3%83%A7%E3%83%96%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B-oidc-%E3%83%88%E3%83%BC%E3%82%AF%E3%83%B3\"\u003eCircleCI の OIDC 対応\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e共有担当: \u003ca href=\"https://twitter.com/miyajan\"\u003e@miyajan\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCircleCI が OpenID Connect (OIDC) をサポートし、永続的なシークレットを使わずに AWS や GCP などのクラウドプロバイダへの認証が可能になりました\n\u003cul\u003e\n\u003cli\u003eGitHub Actions では 2021/10 に同様の機能が公開されていました（\u003ca href=\"https://zenn.dev/miyajan/articles/github-actions-support-openid-connect\"\u003e参考\u003c/a\u003e）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://circleci.com/docs/ja/2.0/openid-connect-tokens/\"\u003eジョブでの OpenID Connect トークンの使用 - CircleCI\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://dev.classmethod.jp/articles/circleci-supported-oidc-so-i-tried-linking-it-with-aws/\"\u003eCircleCIがOpenID ConnectをサポートしたのでAWSと連携させてJWTを使用したAssumeRoleを試してみた | DevelopersIO\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eCircleCI 公式 Orb の OIDC 対応\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://circleci.com/developer/ja/orbs/orb/circleci/aws-cli\"\u003ecircleci/aws-cli\u003c/a\u003e は収録時には OIDC 対応していませんでしたが、配信時には対応された \u003ca href=\"https://github.com/CircleCI-Public/aws-cli-orb/releases/tag/v3.1.0\"\u003ev3.1.0\u003c/a\u003e がリリースされました\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://circleci.com/developer/ja/orbs/orb/circleci/gcp-cli\"\u003ecircleci/gcp-cli\u003c/a\u003e はまだ OIDC サポートされていないため、認証は自前でスクリプトを書く必要があります\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://twitter.com/CircleCIJapan/status/1509025350860255234\"\u003eCircleCI Japan の Tweet\u003c/a\u003e によると、\u003ca href=\"https://circleci.canny.io/orbs/p/extend-existing-orbs-to-support-oidc\"\u003eこちら\u003c/a\u003eを Vote すると Orb 側での対応の優先度が上がるかもしれません\u003c/li\u003e\n\u003cli\u003e一応すでに \u003ca href=\"https://github.com/CircleCI-Public/gcp-cli-orb/issues/41\"\u003eissue\u003c/a\u003e があります\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e\u003ca href=\"https://zenn.dev/korosuke613/articles/productivity-weekly-20220406#%E3%83%9E%E3%83%AB%E3%83%81%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E5%AF%BE%E5%BF%9C%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8%E3%81%AE%E3%83%93%E3%83%AB%E3%83%89%E3%82%92%E3%81%A9%E3%81%86%E3%81%AB%E3%81%8B%E6%97%A9%E3%81%8F%E3%81%97%E3%81%9F%E3%81%8B%E3%81%A3%E3%81%9F---%E3%81%BD%E3%82%88%E3%83%A1%E3%83%A2\"\u003eマルチアーキテクチャ対応イメージのビルドをどうにか早くしたかった\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e共有担当: \u003ca href=\"https://twitter.com/gkzvoice\"\u003e@gkzvoice\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eマルチアーキテクチャ対応イメージのビルドの方法とCI環境での高速化の検証記事です。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edocker manifest\u003c/code\u003e と \u003ccode\u003edocker buildx\u003c/code\u003e どちらもあまりよくわかっていなかったですが、ARM環境下でコンテナを扱うケースは増えるだろうと考え、取り上げました。\u003c/li\u003e\n\u003cli\u003e個人的には、コマンドやビルドの並列実行とコンテナ化を推し進めることで、コンテナ実行環境のCPUアーキテクチャを意識するようになったというのがおもしろいなーと。マルチアーキテクチャなコンテナ環境が一層求められるようになるのか？注目したいですね。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e\u003ca href=\"https://zenn.dev/miroha/articles/whats-docker-compose-v2\"\u003eDocker Compose V2で変わったdocker-compose.ymlの書き方\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e共有担当: \u003ca href=\"https://twitter.com/ganta0087\"\u003e@ganta0087\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDocker Compose v2はv1の記法の後方互換性を保ちつつ、新たに\u003ca href=\"https://github.com/compose-spec/compose-spec/blob/master/spec.md\"\u003eCompose Specification\u003c/a\u003eに準拠した記法が使えるようになりました。\u003c/li\u003e\n\u003cli\u003eDocker ComposeはCompose Specificationのリファレンス実装となっており、他には\u003ca href=\"https://github.com/containerd/nerdctl\"\u003eNerdctl\u003c/a\u003eなどで実装されています。\u003c/li\u003e\n\u003cli\u003eComposeファイルの名前は\u003ccode\u003ecompose.{yaml,yml}\u003c/code\u003eが追加され、探索順はそちらが優先されるようになっていたり、\u003ccode\u003eversion\u003c/code\u003eプロパティの記述が不要となっていたりします。\u003c/li\u003e\n\u003cli\u003eこちらの記事では紹介されていないのですが、\u003ca href=\"https://github.com/compose-spec/compose-spec/blob/master/spec.md#profiles\"\u003eProfiles\u003c/a\u003eが便利だと思いました。\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.docker.com/compose/profiles/\"\u003eDockerのProfilesについてのドキュメント\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e\u003ca href=\"https://github.com/hashicorp/terraform-provider-aws/blob/main/CHANGELOG.md#490-april-07-2022\"\u003eTerraform AWS Provider 4.9.0 (April 07, 2022)リリース\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e共有担当: \u003ca href=\"https://twitter.com/gkzvoice\"\u003e@gkzvoice\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e前提として、AWS Provider 4.0で \u003ccode\u003eaws_s3_bucket\u003c/code\u003e リソースの仕様変更があり、それに合わない書き方はエラー判定とされていました。\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/hashicorp/terraform-provider-aws/issues/23125\"\u003ehttps://github.com/hashicorp/terraform-provider-aws/issues/23125\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e4.9.0 ではエラー判定ではなく、WARNING判定とドリフト検知がされることとなりました。\n\u003cul\u003e\n\u003cli\u003eAWS Providerのバージョンを3.70.0から4.9に引き上げてみたときの作業ログ\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://gkzz.dev/posts/changes-to-s3-bucket-drift-detection-with-aws-provider-v4/\"\u003e[Changes to S3 Bucket Drift Detection] Terraform AWS Provider 4.9のaws_s3_bucketリソースにおけるアップデート内容 | gkzz.dev\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eクラスメソッドさんの検証記事\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://dev.classmethod.jp/articles/terraform-s3-v4-9-0-refactoring/\"\u003e【Terraform】AWS Provider v4.9.0のS3リファクタリングの挙動を試してみた | DevelopersIO\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e今後のアップデートでエラー判定とする仕様に戻るか分からない以上、\u003ccode\u003eaws_s3_bucket\u003c/code\u003e リソースの仕様変更に追随したほうがよいとは思います。検証を重ねて仕様変更にキャッチアップしたいですね。\u003c/li\u003e\n\u003cli\u003e詳細はTerraform のドキュメントの以下のページが一番詳しかったです。\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/guides/version-4-upgrade#changes-to-s3-bucket-drift-detection\"\u003eChanges to S3 Bucket Drift Detection | Terraform Registry\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e\u003ca href=\"https://aws.amazon.com/blogs/aws/announcing-aws-lambda-function-urls-built-in-https-endpoints-for-single-function-microservices/\"\u003eAWS Lambda が単体でHTTPSエンドポイントを持てるようになりました\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e共有担当: \u003ca href=\"https://twitter.com/ganta0087\"\u003e@ganta0087\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eこれまではちょっとしたWebhookのエンドポイントを作りたいときにはAPI Gatewayを併用する必要がありました。\u003c/li\u003e\n\u003cli\u003e設定からFunction URLを有効にすると\u003ccode\u003ehttps://\u0026#x3C;url-id\u003e.lambda-url.\u0026#x3C;region\u003e.on.aws\u003c/code\u003eの形式でURLが払い出されます。\u003c/li\u003e\n\u003cli\u003e対応している認証方式はIAMのみです。\u003c/li\u003e\n\u003cli\u003eWebページ内から呼び出す場合はCORSの設定で許可するオリジンを指定できます。\u003c/li\u003e\n\u003cli\u003e費用はLambdaの呼び出し料金に含まれており、Function URLsの追加による費用はありません。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://dev.classmethod.jp/articles/aws-lambda-function-urls-built-in-https-endpoints/\"\u003e[アップデート]LambdaがHTTPSエンドポイントから実行可能になる、AWS Lambda Function URLsの機能が追加されました！ | DevelopersIO\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e\u003ca href=\"https://zenn.dev/korosuke613/articles/productivity-weekly-20220323#playwright-%26-vite-%E3%81%A7%E3%81%AF%E3%81%98%E3%82%81%E3%82%8B%E8%84%B1%E3%83%AC%E3%82%AC%E3%82%B7%E3%83%BC%E5%90%91%E3%81%91%E8%BB%BD%E9%87%8F-visual-regression-test\"\u003ePlaywright \u0026#x26; Vite ではじめる脱レガシー向け軽量 Visual Regression Test\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e共有担当: \u003ca href=\"https://github.com/korosuke613\"\u003e@korosuke613\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eテストフレームワークの Playwright と TypeScript のビルドツールである Vite を使って軽量な Visual Regression Test (VRT) を行うというノウハウ記事です。VRT の説明や Playwright での始め方、Vite との組合せ方などが載っています。\u003c/p\u003e\n\u003cp\u003e僕もこの記事を参考に自身のホームページに VRT 導入してみました\u003csup\u003e\u003ca href=\"#user-content-fn-unused_vite\" id=\"user-content-fnref-unused_vite\" data-footnote-ref aria-describedby=\"footnote-label\"\u003e2\u003c/a\u003e\u003c/sup\u003e。プルリクエスト時に、CI で main ブランチとトピックブランチそれぞれでビルド＆サーブし、見た目上の差分が無いかを確認します。主に Renovate などを用いた依存関係更新に利用する想定です。時たま不安定になったり、CI 上で比較するには工夫が必要だったりと大変でした。見た目が変わらないことを保証できるのがやはり良く、今では Renovate が作成するプルリクエストを安心して automerge できるようになったのが嬉しいですね。\u003c/p\u003e\n\u003ch2\u003e\u003ca href=\"https://cypress-io.ghost.io/blog/2022/03/28/real-world-testing-with-cypress/\"\u003eIntroducing Real World Testing with Cypress\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e共有担当: \u003ca href=\"https://twitter.com/akihisa1210\"\u003e@akihisa1210\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eE2E テストフレームワーク Cypress を開発している Cypress 社が、チュートリアルサイト \u003ca href=\"https://learn.cypress.io/\"\u003eReal World Testing with Cypress\u003c/a\u003e を公開しました\u003c/li\u003e\n\u003cli\u003eこのサイトは、「開発者が良いテストを書くために知っておくべき情報が散らばっている」という課題を解決するために作られました。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://learn.cypress.io/\"\u003e4コースの学習リソース\u003c/a\u003e、\u003ca href=\"https://learn.cypress.io/real-world-examples\"\u003eテストが書かれたサンプルアプリケーションとその解説\u003c/a\u003e、\u003ca href=\"https://learn.cypress.io/tutorials\"\u003eアプリを作成してテストを書くチュートリアル\u003c/a\u003eが含まれています。\n\u003cul\u003e\n\u003cli\u003e4コースの学習リソースには\u003ca href=\"https://learn.cypress.io/cypress-fundamentals\"\u003eCypress の使い方\u003c/a\u003eだけでなく、\u003ca href=\"https://learn.cypress.io/testing-foundations\"\u003eテストの考え方自体\u003c/a\u003eの学習リソースも含まれているのが特徴的です。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eまた、\u003ca href=\"https://github.com/cypress-io/cypress-realworld-testing\"\u003eサイト自体が OSS として公開されており\u003c/a\u003e、\u003ca href=\"https://github.com/cypress-io/cypress-realworld-testing/tree/main/cypress/integration\"\u003eE2E テストが Cypress で書かれています\u003c/a\u003e。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eその他の注目ネタ\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eGitHub\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://zenn.dev/korosuke613/articles/productivity-weekly-20220323#github-actions%3A-restrict-self-hosted-runner-groups-to-specific-workflows-%7C-github-changelog\"\u003e指定したワークフローのみ利用を許可する設定をセルフホストランナーグループにできるようになりました\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zenn.dev/korosuke613/articles/productivity-weekly-20220323#introducing-the-ghes-repository-cache-%7C-the-github-blog\"\u003eGHESでGitリポジトリのキャッシュサーバを利用できるようになりました\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zenn.dev/korosuke613/articles/productivity-weekly-20220330#ignore-commits-in-the-blame-view-(beta)-%7C-github-changelog\"\u003eIgnore commits in the blame view (Beta) | GitHub Changelog\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zenn.dev/korosuke613/articles/productivity-weekly-20220413#github-action-for-dependency-review-enforcement-%7C-github-changelog\"\u003e依存関係をレビューする公式 GitHub Actions アクションが登場しました\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eCircleCI\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://zenn.dev/korosuke613/articles/productivity-weekly-20220316#ubuntu-14.04-and-16.04-image-deprecation---circleci-changelog\"\u003eUbuntu 14.04、16.04 のマシンイメージが使えなくなるよ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eTerraform\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://zenn.dev/korosuke613/articles/productivity-weekly-20220323#terraform-%E3%81%A8-gcloud-cli-%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E5%AE%8C%E7%92%A7%E3%81%AA-google-cloud-%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E3%82%B9%E3%83%88%E3%83%A9%E3%82%AF%E3%83%81%E3%83%A3%E3%81%AE%E6%A7%8B%E7%AF%89-%7C-google-cloud-blog\"\u003eTerraform と gcloud CLI を使用した完璧な Google Cloud インフラストラクチャの構築 | Google Cloud Blog\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eその他\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://zenn.dev/korosuke613/articles/productivity-weekly-20220316#ssh-and-git%2C-meet-1password-%F0%9F%A5%B0\"\u003eSSH and Git, meet 1Password 🥰\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zenn.dev/korosuke613/articles/productivity-weekly-20220323#twitterdev%2Ftwitter-api-typescript-sdk%3A-a-typescript-sdk-for-the-twitter-api\"\u003etwitterdev/twitter-api-typescript-sdk: A TypeScript SDK for the Twitter API\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zenn.dev/korosuke613/articles/productivity-weekly-20220406#technology-radar-%7C-an-opinionated-guide-to-technology-frontiers-%7C-thoughtworks\"\u003eTechnology Radar Vol.26が公開\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch1\u003eWe are hiring\u003c/h1\u003e\n\u003ca href=\"https://note.com/cybozu_dev/n/n1c1b44bf72f6\"\u003e\n\u003cimg src=\"https://user-images.githubusercontent.com/471182/156986297-b189ef3d-98d3-4490-af5c-007a4ab47e5e.png\" alt=\"サイボウズの開発者の生産性を上げる「生産性向上チーム」とは！？\" width=\"600\"\u003e\n\u003c/a\u003e\n\u003csection data-footnotes class=\"footnotes\"\u003e\u003ch2 id=\"footnote-label\" class=\"sr-only\"\u003eFootnotes\u003c/h2\u003e\n\u003col\u003e\n\u003cli id=\"user-content-fn-strong_user\"\u003e\n\u003cp\u003e強い権限を持ったユーザの Personal Access Token を使うなどすれば良いけど、あんまり強い権限のトークンを出したくなかったり、Actions の場合は GITHUB_TOKEN を使いたかったりしますよね。 \u003ca href=\"#user-content-fnref-strong_user\" data-footnote-backref class=\"data-footnote-backref\" aria-label=\"Back to content\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"user-content-fn-unused_vite\"\u003e\n\u003cp\u003e詳しくはこの\u003ca href=\"https://github.com/korosuke613/myHomepage/compare/9f248dab326ee93b9e12c83d15f80f68692f0602..045bd4624f464fe09a255eb11f10df602fd062c8\"\u003e差分\u003c/a\u003eと \u003ca href=\"https://app.circleci.com/pipelines/github/korosuke613/myHomepage\"\u003eCI\u003c/a\u003e の \u003ccode\u003evisual-regression-testing\u003c/code\u003e ワークフローを参照。Vite の導入は型周りでのエラーが頻発して導入を諦めました... \u003ca href=\"#user-content-fnref-unused_vite\" data-footnote-backref class=\"data-footnote-backref\" aria-label=\"Back to content\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/section\u003e\n"}},"__N_SSG":true},"page":"/posts/[year]/[slug]","query":{"year":"2022","slug":"04-28"},"buildId":"rboL0jIl_DVyWORxnmwl7","assetPrefix":"/productivity-news","runtimeConfig":{"basePath":"/productivity-news"},"isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>